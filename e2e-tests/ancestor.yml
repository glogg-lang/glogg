run:
  ancestor:
    prerequisiteCwd: .
    prerequisites:
      - rm app.glogg.db || true
      - npx glg init
      - 'echo "{{code}}" | npx glg edit --from=stdin'
      - npx glg make
    command: node app.js
    expectCode: 0
    outputContains:
      - Hewie
      - Dewie
      - Louie
vars:
  code: |
    commit:
      [ #duck name: \"Scrooge\" ]
      [ #duck name: \"Donald\" uncle: \"Scrooge\" ]
      [ #duck name: \"Hewie\" uncle: \"Donald\" ]
      [ #duck name: \"Dewie\" uncle: \"Donald\" ]
      [ #duck name: \"Louie\" uncle: \"Donald\" ]

    search:
      [ #duck name: scrooges-nephew uncle: \"Scrooge\" ]
      [ #duck name: name uncle: scrooges-nephew ]
    commit @stdio:
      [ #log message: name ]
